import './polyfills.server.mjs';
import{a as D}from"./chunk-5JWONV3O.mjs";import{a as M}from"./chunk-3OAVVQER.mjs";import{x as U}from"./chunk-6UOH6BPV.mjs";import{a as L,b as j}from"./chunk-H2FZU6DH.mjs";import{r as T}from"./chunk-IRK2UOVA.mjs";import{m as N,n as k,o as E,q as F}from"./chunk-RL6AEQ4N.mjs";import{$a as r,Ab as y,Ca as a,Da as x,Ra as p,Ta as l,W as C,_a as s,ab as m,da as b,db as v,ea as h,gb as _,hb as u,ob as d,pb as g,qb as S,xb as I,ya as w,yb as P,zb as f}from"./chunk-KLZ53CP7.mjs";var $=()=>[],A=(i,o)=>({"bg-red-100 text-red-700 border border-red-500 opacity-60":i,"bg-white text-gray-800":o}),V=i=>["/noticiadetalle",i],O=i=>["/editar-noticia",i],z=(i,o)=>({"bg-blue-900 text-white":i,"bg-gray-300":o});function R(i,o){if(i&1&&(s(0,"button",20),m(1,"i",21),d(2," Editar "),r()),i&2){let e=u(2);l("routerLink",f(1,O,e.noticiaPrincipal.id))}}function B(i,o){if(i&1){let e=v();s(0,"button",22),_("click",function(){b(e);let n=u(2);return h(n.borrarNoticia(n.noticiaPrincipal.id))}),m(1,"i",23),d(2," Borrar "),r()}}function q(i,o){if(i&1&&(s(0,"div",10)(1,"div",11),m(2,"img",12),r(),s(3,"div",13)(4,"h3",14),d(5),r(),s(6,"p",15),d(7),r(),s(8,"div",16)(9,"a",17),d(10," Leer m\xE1s "),r(),p(11,R,3,3,"button",18)(12,B,3,0,"button",19),r()()()),i&2){let e=u();l("ngClass",y(8,A,!e.noticiaPrincipal.vigente,e.noticiaPrincipal.vigente)),a(2),l("src",e.noticiaPrincipal.imagen.url,w)("alt",e.noticiaPrincipal.imagen.alt),a(3),g(e.noticiaPrincipal.titulo),a(2),g(e.truncateText(e.noticiaPrincipal.descripcion||"",150)),a(2),l("routerLink",f(11,V,e.noticiaPrincipal.id)),a(2),l("ngIf",e.rol==="ADMIN"),a(),l("ngIf",e.rol==="ADMIN")}}function G(i,o){if(i&1&&(s(0,"button",33),m(1,"i",21),r()),i&2){let e=u().$implicit;l("routerLink",f(1,O,e==null?null:e.id))}}function H(i,o){if(i&1){let e=v();s(0,"button",34),_("click",function(){b(e);let n=u().$implicit,c=u();return h(c.borrarNoticia(n.id))}),m(1,"i",23),r()}}function J(i,o){if(i&1&&(s(0,"div",24)(1,"div",25)(2,"div",26),m(3,"img",12),r(),s(4,"h4",27),d(5),r(),s(6,"p",28),d(7),r()(),s(8,"div",29)(9,"a",30),d(10," Leer m\xE1s "),r(),p(11,G,2,3,"button",31)(12,H,2,0,"button",32),r()()),i&2){let e=o.$implicit,t=u();l("ngClass",y(8,A,!e.vigente,e.vigente)),a(3),l("src",e.imagen.url,w)("alt",e.imagen.alt),a(2),g(e.titulo),a(2),g(t.truncateText(e.descripcion,80)),a(2),l("routerLink",f(11,V,e.id)),a(2),l("ngIf",t.rol==="ADMIN"),a(),l("ngIf",t.rol==="ADMIN")}}function K(i,o){if(i&1){let e=v();s(0,"button",35),_("click",function(){let n=b(e).index,c=u();return h(c.setPage(n+1))}),d(1),r()}if(i&2){let e=o.index,t=u();l("ngClass",y(2,z,t.currentPage===e+1,t.currentPage!==e+1)),a(),S(" ",e+1," ")}}var ot=(()=>{let o=class o{constructor(t,n,c){this.noticiasService=t,this.imagenService=n,this.auth=c,this.imageUrls=[],this.authUrl=L.apiUrl+"auth/imagenes",this.rol="",this.noticiasPaginadas=[],this.currentPage=1,this.pageSize=6,this.largo=0}ngOnInit(){this.cargarNoticias(),this.auth.isAuthenticated()&&(this.rol=String(localStorage.getItem("rol")))}cargarNoticias(){this.noticiasService.getNoticias().subscribe(t=>{this.rol==="ADMIN"?this.listanoticias=t:this.listanoticias=t.filter(n=>n.vigente),this.largo=this.listanoticias.length,this.listanoticias.sort((n,c)=>new Date(c.fecha).getTime()-new Date(n.fecha).getTime()),this.listanoticias.length>0&&(this.noticiaPrincipal=this.listanoticias[0],this.listanoticias.shift()),this.convertToUrls(),this.setPage(this.currentPage)})}borrarNoticia(t){this.noticiasService.deleteNoticia(t).subscribe(()=>{this.listanoticias=this.listanoticias.filter(n=>n.id!==t),this.setPage(this.currentPage)})}loadFile(t){this.imagenService.getImagenFileAuth(t).subscribe(n=>{let c=URL.createObjectURL(n);this.fileUrl=c})}convertToUrls(){if(this.listanoticias.forEach(t=>{let n=t.imagen.id;t.imagen.url=`${this.authUrl}/archivo/${n}`,console.log("imagen: "+t.imagen.id+" url: "+t.imagen.url)}),this.noticiaPrincipal){let t=this.noticiaPrincipal.imagen.id;this.noticiaPrincipal.imagen.url=`${this.authUrl}/archivo/${t}`}}setPage(t){this.currentPage=t;let n=(t-1)*this.pageSize;this.noticiasPaginadas=this.listanoticias.slice(n,n+this.pageSize)}get totalPages(){return Math.ceil(this.largo/this.pageSize)}truncateText(t,n){return t.length>n?t.substring(0,n)+"...":t}};o.\u0275fac=function(n){return new(n||o)(x(D),x(M),x(j))},o.\u0275cmp=C({type:o,selectors:[["app-noticias-card"]],standalone:!0,features:[I],decls:11,vars:4,consts:[[1,"news-section","py-5","bg-gray-100"],[1,"container","mx-auto","p-4"],[1,"text-3xl","text-center","font-bold","text-blue-900","uppercase","tracking-wide","relative","mb-10"],[1,"block","bg-orange-500","h-1","w-20","mx-auto","mt-2"],[1,"block","bg-blue-900","h-1","w-10","mx-auto","mt-2"],["class","flex flex-col sm:flex-row justify-between bg-white shadow-lg rounded-lg mb-10 p-4","id","noticias-section",3,"ngClass",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-6"],["class","shadow-lg rounded-lg p-6 flex flex-col justify-between h-full transition-opacity duration-300",3,"ngClass",4,"ngFor","ngForOf"],[1,"flex","justify-center","mt-6"],["class","mx-1 px-3 py-1 rounded-full font-semibold",3,"ngClass","click",4,"ngFor","ngForOf"],["id","noticias-section",1,"flex","flex-col","sm:flex-row","justify-between","bg-white","shadow-lg","rounded-lg","mb-10","p-4",3,"ngClass"],[1,"main-news-image","sm:w-96","w-full","h-60","flex","items-center","justify-center","overflow-hidden","rounded-lg","bg-gray-200","mb-4","sm:mb-0"],[1,"w-full","h-full","object-contain",3,"src","alt"],[1,"main-news-content","flex-1","sm:pl-6"],[1,"text-2xl","text-gray-800","mb-4"],[1,"text-gray-600","mb-4"],[1,"flex","flex-wrap","items-center","justify-center","sm:justify-start","space-x-2","space-y-2","sm:space-y-0"],[1,"btn-read-more","bg-orange-500","text-white","py-2","px-4","rounded-full","font-semibold","hover:bg-gray-800","transition-colors","duration-300","mb-2","sm:mb-0",3,"routerLink"],["class","bg-blue-500 text-white py-2 px-4 rounded-full font-semibold hover:bg-blue-700 transition-colors duration-300 mb-2 sm:mb-0",3,"routerLink",4,"ngIf"],["class","bg-red-500 text-white py-2 px-4 rounded-full font-semibold hover:bg-red-700 transition-colors duration-300 mb-2 sm:mb-0",3,"click",4,"ngIf"],[1,"bg-blue-500","text-white","py-2","px-4","rounded-full","font-semibold","hover:bg-blue-700","transition-colors","duration-300","mb-2","sm:mb-0",3,"routerLink"],[1,"fas","fa-pencil-alt"],[1,"bg-red-500","text-white","py-2","px-4","rounded-full","font-semibold","hover:bg-red-700","transition-colors","duration-300","mb-2","sm:mb-0",3,"click"],[1,"fas","fa-trash-alt"],[1,"shadow-lg","rounded-lg","p-6","flex","flex-col","justify-between","h-full","transition-opacity","duration-300",3,"ngClass"],[1,"flex-1"],[1,"w-full","h-40","flex","items-center","justify-center","overflow-hidden","rounded-lg","bg-gray-200"],[1,"text-xl","mb-2","mt-4"],[1,"mb-4"],[1,"flex","flex-wrap","items-center","justify-center","space-x-2","space-y-2","sm:space-y-0"],[1,"btn-read-more","bg-orange-500","text-white","py-2","px-4","rounded-full","font-semibold","hover:bg-gray-800","transition-colors","duration-300",3,"routerLink"],["class","bg-blue-500 text-white py-2 px-4 rounded-full font-semibold hover:bg-blue-700 transition-colors duration-300",3,"routerLink",4,"ngIf"],["class","bg-red-500 text-white py-2 px-4 rounded-full font-semibold hover:bg-red-700 transition-colors duration-300",3,"click",4,"ngIf"],[1,"bg-blue-500","text-white","py-2","px-4","rounded-full","font-semibold","hover:bg-blue-700","transition-colors","duration-300",3,"routerLink"],[1,"bg-red-500","text-white","py-2","px-4","rounded-full","font-semibold","hover:bg-red-700","transition-colors","duration-300",3,"click"],[1,"mx-1","px-3","py-1","rounded-full","font-semibold",3,"click","ngClass"]],template:function(n,c){n&1&&(s(0,"section",0)(1,"div",1)(2,"h2",2),d(3," \xDAltimas Noticias "),m(4,"span",3)(5,"span",4),r(),p(6,q,13,13,"div",5),s(7,"div",6),p(8,J,13,13,"div",7),r(),s(9,"div",8),p(10,K,2,5,"button",9),r()()()),n&2&&(a(6),l("ngIf",c.noticiaPrincipal),a(2),l("ngForOf",c.noticiasPaginadas),a(2),l("ngForOf",P(3,$).constructor(c.totalPages)))},dependencies:[F,N,k,E,U,T]});let i=o;return i})();export{ot as a};
