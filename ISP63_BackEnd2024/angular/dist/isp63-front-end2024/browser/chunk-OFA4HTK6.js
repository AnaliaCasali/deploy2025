import{a as b}from"./chunk-4ATTAGCL.js";import{a as v}from"./chunk-SJWRDQVH.js";import{a as p,b as g}from"./chunk-EITPQ4QS.js";import{a as f,c as d}from"./chunk-5KY6YBJG.js";import{I as s,M as m,R as l,j as h,k as n,v as a}from"./chunk-X5N6KVFF.js";import{e as x}from"./chunk-EQDQRRRY.js";var o=x(v());var O=(()=>{let r=class r{constructor(t,i,e){this.http=t,this.authService=i,this.notificacionService=e,this.apiUrl=p.apiUrl+"api/noticias",this.authUrl=p.apiUrl+"auth/noticias",this.dni=""}getHeaders(){let t=new f;if(this.authService.isAuthenticated()){let i=localStorage.getItem("authToken");this.dni=String(localStorage.getItem("dni")),t=t.set("Authorization",`Bearer ${i}`)}return t}ObtenerDatos(){return this.http.get(`${this.authUrl}`).pipe(a(t=>h([])))}getNoticias(){return this.http.get(this.authUrl).pipe(a(t=>h([])))}getNoticia(t){return this.http.get(`${this.authUrl}/${t}`).pipe()}handleError(t){return console.error("Ha ocurrido un error",t),n(t.message||"Server Error")}createNoticia(t){let i=this.getHeaders();return this.http.post(this.apiUrl,t,{headers:i}).pipe(s(e=>{o.default.fire({icon:"success",title:"Genial!",text:"La noticia se registro exitosamente.",confirmButtonText:"OK"}),this.dni?this.notificacionService.crearNotificacion("Noticia creada",this.dni).subscribe(()=>console.log("Notificaci\xF3n creada correctamente"),c=>console.error("Error al crear la notificaci\xF3n",c)):console.error("DNI no est\xE1 definido")}),a(e=>(o.default.fire({icon:"error",title:"Error",text:"Hubo un problema guardar. Int\xE9ntalo nuevamente.",confirmButtonText:"OK"}),console.error("Error al subir noticia",e),n(e))))}updateNoticia(t,i){let e=this.getHeaders();return this.http.put(`${this.apiUrl}/${t}`,i,{headers:e}).pipe(s(c=>{o.default.fire({icon:"success",title:"Actualizaci\xF3n exitosa!",text:"La noticia fue actualizada correctamente.",confirmButtonText:"OK"}),this.notificacionService.crearNotificacion("Noticia actualizada",this.dni).subscribe()}),a(c=>(o.default.fire({icon:"error",title:"Error en la actualizaci\xF3n",text:"Hubo un problema al actualizar la noticia. Int\xE9ntalo nuevamente.",confirmButtonText:"OK"}),n(c))))}deleteNoticia(t){let i=this.getHeaders();return this.http.delete(`${this.apiUrl}/${t}`,{headers:i}).pipe(s(()=>{o.default.fire({icon:"success",title:"Eliminaci\xF3n exitosa!",text:"La noticia fue eliminada correctamente.",confirmButtonText:"OK"}),this.notificacionService.crearNotificacion("Noticia eliminada",this.dni).subscribe()}),a(e=>(o.default.fire({icon:"error",title:"Error en la eliminaci\xF3n",text:`Hubo un problema al eliminar la noticia con id ${t}. Int\xE9ntalo nuevamente.`,confirmButtonText:"OK"}),n(e))))}};r.\u0275fac=function(i){return new(i||r)(l(d),l(g),l(b))},r.\u0275prov=m({token:r,factory:r.\u0275fac,providedIn:"root"});let u=r;return u})();export{O as a};
