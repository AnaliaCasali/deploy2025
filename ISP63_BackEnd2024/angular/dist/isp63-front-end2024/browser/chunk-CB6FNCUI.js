import{a as v}from"./chunk-SJWRDQVH.js";import{a as f,b as m}from"./chunk-5AS2EY2S.js";import{a as l,c as d}from"./chunk-5KY6YBJG.js";import{M as u,R as p,k as s,v as o}from"./chunk-X5N6KVFF.js";import{e as $}from"./chunk-EQDQRRRY.js";var g=$(v());var b=(()=>{let r=class r{constructor(e,t){this.http=e,this.authService=t,this.apiUrl=f.apiUrl+"api/notificaciones"}getHeaders(){let e=new l;if(this.authService.isAuthenticated()){let t=localStorage.getItem("authToken");e=e.set("Authorization",`Bearer ${t}`)}return e}obtenerTodas(){let e=this.getHeaders();return this.http.get(this.apiUrl,{headers:e}).pipe(o(this.handleError))}obtenerNoLeidas(e){let t=this.getHeaders();return this.http.get(`${this.apiUrl}/no-leidas/${e}`,{headers:t}).pipe(o(this.handleError))}crearNotificacion(e,t){let n=this.getHeaders(),c={mensaje:e,usuarioDestinoDni:t};return this.http.post(this.apiUrl,c,{headers:n,responseType:"text"}).pipe(o(i=>(console.error("Error al crear la notificaci\xF3n",i),s(i))))}enviarNotificacionARoles(e,t){let n=new l({"Content-Type":"application/json"}),c={mensaje:e,rol:[]};return this.http.post(`${this.apiUrl}/enviar-a-roles`,c,{headers:n}).pipe(o(i=>{let h="Error al enviar notificaci\xF3n";return i.status===400?h=`Error de validaci\xF3n: ${i.error}`:i.status===500&&(h=`Error en el servidor: ${i.error}`),s(()=>new Error(h))}))}marcarComoLeida(e){let t=this.getHeaders();return console.log(`${this.apiUrl}/leer/${e}`),this.http.put(`${this.apiUrl}/leer/${e}`,{headers:t,responseType:"text"}).pipe()}eliminarNotificacion(e){let t=this.getHeaders();return console.log(`${this.apiUrl}/leer/${e}`),this.http.delete(`${this.apiUrl}/${e}`,{headers:t}).pipe()}contarNotificacionesNoLeidas(e){let t=this.getHeaders();return this.http.get(`${this.apiUrl}/noleidas/${e}`,{headers:t})}handleError(e){return console.error("Ocurri\xF3 un error",e),g.default.fire({icon:"error",title:"Error",text:"Ocurri\xF3 un problema. Int\xE9ntalo de nuevo.",confirmButtonText:"OK"}),s(e.message||"Server Error")}};r.\u0275fac=function(t){return new(t||r)(p(d),p(m))},r.\u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();export{b as a};
