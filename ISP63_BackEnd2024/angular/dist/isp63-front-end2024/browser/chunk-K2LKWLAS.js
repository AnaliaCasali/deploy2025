import{a as z}from"./chunk-UBAW45YS.js";import{a as R}from"./chunk-OQIJA6UF.js";import{a as L}from"./chunk-CB6FNCUI.js";import{a as N}from"./chunk-SJWRDQVH.js";import{a as g,b as B}from"./chunk-5AS2EY2S.js";import{a as F,c as H}from"./chunk-5KY6YBJG.js";import{l as T,o as $}from"./chunk-4DCJT2OD.js";import{Aa as c,Ba as x,I as v,M as y,Pa as I,R as b,Ra as S,W as w,Ya as o,Za as a,_a as E,fa as U,gb as O,j as u,k as h,mb as l,nb as p,v as s,vb as j,wa as k}from"./chunk-X5N6KVFF.js";import"./chunk-QMQTSFHS.js";import"./chunk-FK6H3RFT.js";import{e as C}from"./chunk-EQDQRRRY.js";var m=C(N());var A=(()=>{let i=class i{constructor(e,t,r){this.http=e,this.authService=t,this.notificacionService=r,this.apiUrl=g.apiUrl+"api/eventos",this.authUrl=g.apiUrl+"auth/eventos",this.dni=""}getHeaders(){let e=new F;if(this.authService.isAuthenticated()){let t=localStorage.getItem("authToken");this.dni=String(localStorage.getItem("dni")),e=e.set("Authorization",`Bearer ${t}`)}return e}ObtenerDatos(){return this.http.get(`${this.authUrl}`).pipe(s(e=>u([])))}getEventos(){return this.http.get(this.authUrl).pipe(s(e=>u([])))}getEventosConFiles(){return this.http.get(`${this.authUrl}/confiles`).pipe(s(e=>u([])))}getEvento(e){return this.http.get(`${this.authUrl}/${e}`).pipe(s(this.handleError))}createEvento(e){let t=this.getHeaders();return this.http.post(this.apiUrl,e,{headers:t}).pipe(v(r=>{m.default.fire({icon:"success",title:"Genial!",text:"El evento se creo exitosamente.",confirmButtonText:"OK"}),this.dni?this.notificacionService.crearNotificacion("Evento creado",this.dni).subscribe(()=>console.log("Notificaci\xF3n creada correctamente"),f=>console.error("Error al crear la notificaci\xF3n",f)):console.error("DNI no est\xE1 definido")}),s(r=>(m.default.fire({icon:"error",title:"Error",text:"Hubo un problema guardar. Int\xE9ntalo nuevamente.",confirmButtonText:"OK"}),console.error("Error al subir evento",r),h(r))))}updateEvento(e,t){let r=this.getHeaders();return this.http.put(`${this.apiUrl}/${e}`,t,{headers:r}).pipe(v(f=>{m.default.fire({icon:"success",title:"Actualizaci\xF3n exitosa!",text:"El evento fue actualizado correctamente.",confirmButtonText:"OK"}),this.notificacionService.crearNotificacion("Evento actualizado",this.dni).subscribe()}),s(f=>(m.default.fire({icon:"error",title:"Error en la actualizaci\xF3n",text:"Hubo un problema al actualizar la evento. Int\xE9ntalo nuevamente.",confirmButtonText:"OK"}),h(f))))}deleteEvento(e){let t=this.getHeaders();return this.http.delete(`${this.apiUrl}/${e}`,{headers:t}).pipe(v(()=>{m.default.fire({icon:"success",title:"Eliminaci\xF3n exitosa!",text:"La evento fue eliminado correctamente.",confirmButtonText:"OK"}),this.notificacionService.crearNotificacion("Evento eliminado",this.dni).subscribe()}),s(r=>(m.default.fire({icon:"error",title:"Error en la eliminaci\xF3n",text:`Hubo un problema al eliminar la evento con id ${e}. Int\xE9ntalo nuevamente.`,confirmButtonText:"OK"}),h(r))))}handleError(e){let t=this.getHeaders();return console.warn("A ocurrido un error",e),h(e.message||"Server Error")}};i.\u0275fac=function(t){return new(t||i)(b(H),b(B),b(L))},i.\u0275prov=y({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();function P(n,i){if(n&1&&(o(0,"div",7)(1,"a",8)(2,"div",9),E(3,"img",10),a()(),o(4,"div",11)(5,"a",8)(6,"h5",12),l(7),a()(),o(8,"p",13),l(9),a(),o(10,"p",14),l(11),a(),o(12,"p",15),l(13),a(),o(14,"a",16),l(15," Leer m\xE1s "),U(),o(16,"svg",17),E(17,"path",18),a()()()()),n&2){let d=i.$implicit;c(3),O("alt",d.imagen.alt),S("src",d.imagen.url,k),c(4),p(d.titulo),c(2),p(d.subitulo),c(2),p(d.descripcion),c(2),p(d.fecha)}}var te=(()=>{let i=class i{constructor(e,t,r){this.eventoService=e,this.imagenService=t,this.aPdfService=r,this.imageUrls=[],this.authUrl=g.apiUrl+"auth/imagenes"}ngOnInit(){this.eventoService.getEventos().subscribe(e=>{this.eventos=e,this.convertToUrls()})}aPdf(e,t){this.aPdfService.GenerarPdf(e,t)}loadFile(e){this.imagenService.getImagenFileAuth(e).subscribe(t=>{console.log("Tipo de Blob: ",t.type);let r=URL.createObjectURL(t);this.fileUrl=r})}convertToUrls(){this.eventos.forEach(e=>{let t=e.imagen.id;e.imagen.url=`${this.authUrl}/archivo/${t}`})}convertBlobsToUrls(){this.eventos.forEach(e=>{let t=e.imagen.id;this.imagenService.getImagenFileAuth(t).subscribe({next:r=>{e.imagen.url=URL.createObjectURL(r)},error:r=>(console.warn(" imagen ERROR:"+e.imagen.url+" error: "+r),console.error("Error al cargar la imagen"+e.id+e.imagen.url+" error: "+r),u([]))})})}deleteEvento(e){this.eventoService.deleteEvento(e).subscribe(()=>{this.eventos=this.eventos.filter(t=>t.id!==e)})}ngOnDestroy(){this.eventos.forEach(e=>{e?.imagen?.url&&URL.revokeObjectURL(e.imagen.url)})}};i.\u0275fac=function(t){return new(t||i)(x(A),x(R),x(z))},i.\u0275cmp=w({type:i,selectors:[["app-eventos-view"]],standalone:!0,features:[j],decls:8,vars:1,consts:[[1,"news-section","py-24","bg-gray-100"],[1,"mt-18","mx-10"],[1,"text-3xl","text-center","font-bold","text-blue-900","uppercase","tracking-wide","relative","mb-10"],[1,"block","bg-orange-500","h-1","w-20","mx-auto","mt-2"],[1,"block","bg-blue-900","h-1","w-10","mx-auto","mt-2"],[1,"grid","grid-cols-3","gap-4"],["class","bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700",4,"ngFor","ngForOf"],[1,"bg-white","border","border-gray-200","rounded-lg","shadow","dark:bg-gray-800","dark:border-gray-700"],["href","#"],[1,"flex","justify-center"],[1,"rounded-t-lg","w-64","h-65","object-cover",3,"src","alt"],[1,"p-5"],[1,"mb-2","text-2xl","font-bold","tracking-tight","text-gray-900","dark:text-black"],[1,"mb-2","text-lg","font-semibold","text-gray-900","dark:text-gray-300"],[1,"mb-2","font-normal","text-gray-700","dark:text-gray-400"],[1,"mb-3","font-light","text-sm","text-gray-600","dark:text-gray-400"],["href","#",1,"inline-flex","items-center","px-3","py-2","text-sm","font-medium","text-center","text-white","bg-blue-700","rounded-lg","hover:bg-blue-800","focus:ring-4","focus:outline-none","focus:ring-blue-300","dark:bg-blue-600","dark:hover:bg-blue-700","dark:focus:ring-blue-800"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 10",1,"rtl:rotate-180","w-3.5","h-3.5","ms-2"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M1 5h12m0 0L9 1m4 4L9 9"]],template:function(t,r){t&1&&(o(0,"section",0)(1,"div",1)(2,"h2",2),l(3," Eventos "),E(4,"span",3)(5,"span",4),a(),o(6,"div",5),I(7,P,18,6,"div",6),a()()()),t&2&&(c(7),S("ngForOf",r.eventos))},dependencies:[$,T]});let n=i;return n})();export{te as EventosViewComponent};
